<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-spring4-4.dtd">

<html xmlns:th="http://www.thymeleaf.org"
      xmlns="http://www.w3.org/1999/xhtml">

<head>
    <title>Patients</title>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <link rel="stylesheet" href="./../static/mupacs.css" th:href="@{/mupacs.css}"/>
</head>

<body>
<div class="container-fluid">

    <div th:replace="~{fragments/menu :: menu}">MENU</div>

    <h2>Patients</h2>

    <div class="row patient-list-container">
        <!-- Left Column: Patient List -->
        <div class="col-md-4 patient-list-column">
            <h4>Patient List</h4>

            <!-- Patient List Items -->
            <div th:each="p : ${patients}">
                <div th:replace="~{fragments/patientListItem :: patientItem(${p})}"></div>
            </div>

            <!-- Pagination Controls -->
            <div th:replace="~{fragments/pagination :: pagination(${currentPage}, ${totalPages}, ${pageSize}, ${totalItems})}"></div>
        </div>

        <!-- Right Column: Patient Details -->
        <div class="col-md-8 patient-details-column">
            <div th:each="p : ${patients}"
                 th:id="'patient-details-' + ${p.id}"
                 class="patient-details-content">

                <h4>Patient Details</h4>

                <!-- Patient Demographics -->
                <div th:replace="~{fragments/patientDemographics :: demographics(${p})}"></div>

                <!-- Medical Information -->
                <div th:replace="~{fragments/patientMedicalInfo :: medicalInfo(${p})}"></div>

                <!-- Studies Section -->
                <h4 th:if="${p.numberOfStudies > 0}">
                    Studies (<span th:text="${p.numberOfStudies}">0</span>)
                </h4>
                <div th:if="${p.numberOfStudies == 0}" class="alert alert-info">
                    No studies available for this patient.
                </div>

                <div th:each="study : ${p.studies}">
                    <div th:replace="~{fragments/studyPanel :: studyPanel(${study}, ${p})}"></div>
                </div>
            </div>

            <!-- Placeholder when no patient selected -->
            <div id="no-selection-placeholder" class="details-placeholder">
                <span class="glyphicon glyphicon-hand-left placeholder-icon"></span>
                <h4>Select a patient from the list</h4>
                <p>Click on a patient to view their details, studies, series, and instances.</p>
            </div>
        </div>
    </div>

    <script th:replace="~{fragments/patientListScripts :: patientListScripts}"></script>

    <div th:replace="~{fragments/footer :: footer}">EMPTY FOOTER</div>

</div>
</body>
</html>